import { useState, useEffect } from 'react';
import { ethers } from 'ethers';
import { useWallets } from '@privy-io/react-auth';
import { AMM_ADDRESS } from './ammConfig';

// SimpleAMM bytecode (from contracts/SimpleAMM.json after compilation)
// This bytecode is for SimpleAMM contract version compiled with solc 0.8.30
const SimpleAMMBytecode = '0x6080604052348015600e575f5ffd5b506125518061001c5f395ff3fe608060405260043610610094575f3560e01c806355776b771161005857806355776b77146101c05780638aaae305146101f0578063a4063dbc1461022c578063b039ddf61461026b578063c464fe65146102875761009b565b80630752881a1461009f5780631bf6e958146100cf5780631e1c6a071461010b5780633e99c1e41461014757806341976e09146101845761009b565b3661009b57005b5f5ffd5b6100b960048036038101906100b49190611c52565b6102c3565b6040516100c69190611c9f565b60405180910390f35b3480156100da575f5ffd5b506100f560048036038101906100f09190611c52565b610737565b6040516101029190611c9f565b60405180910390f35b348015610116575f5ffd5b50610131600480360381019061012c9190611cb8565b6108d0565b60405161013e9190611cfd565b60405180910390f35b348015610152575f5ffd5b5061016d60048036038101906101689190611cb8565b6108ed565b60405161017b929190611d16565b60405180910390f35b34801561018f575f5ffd5b506101aa60048036038101906101a59190611cb8565b610a48565b6040516101b79190611c9f565b60405180910390f35b6101da60048036038101906101d59190611d3d565b610bd2565b6040516101e79190611c9f565b60405180910390f35b3480156101fb575f5ffd5b5061021660048036038101906102119190611c52565b611088565b6040516102239190611c9f565b60405180910390f35b348015610237575f5ffd5b50610252600480360381019061024d9190611cb8565b611221565b6040516102629493929190611d9c565b60405180910390f35b61028560048036038101906102809190611d3d565b61126b565b005b348015610292575f5ffd5b506102ad60048036038101906102a89190611c52565b611743565b6040516102ba9190611c9f565b60405180910390f35b5f60015f8473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f9054906101000a900460ff1661034d576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161034490611e39565b60405180910390fd5b5f821161038f576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161038690611ea1565b60405180910390fd5b5f5f341161039d578261039f565b345b9050828110156103e4576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016103db90611f09565b60405180910390fd5b5f5f5f8673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f2090508181600201546104339190611f54565b8282600101546104439190611f87565b61044d9190611ff5565b92505f8311610491576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016104889061206f565b60405180910390fd5b80600101548311156104d8576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016104cf906120d7565b60405180910390fd5b81816002015f8282546104eb9190611f54565b9250508190555082816001015f82825461050591906120f5565b925050819055505f5f8673ffffffffffffffffffffffffffffffffffffffff163386604051602401610538929190612128565b6040516020818303038152906040527fa9059cbb000000000000000000000000000000000000000000000000000000007bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19166020820180517bffffffffffffffffffffffffffffffffffffffffffffffffffffffff83818316178352505050506040516105c291906121a1565b5f604051808303815f865af19150503d805f81146105fb576040519150601f19603f3d011682016040523d82523d5f602084013e610600565b606091505b509150915081801561062d57505f8151148061062c57508080602001905181019061062b91906121e1565b5b5b61066c576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161066390612256565b60405180910390fd5b833411156106c4573373ffffffffffffffffffffffffffffffffffffffff166108fc853461069a91906120f5565b90811502906040515f60405180830381858888f193505050501580156106c2573d5f5f3e3d5ffd5b505b3373ffffffffffffffffffffffffffffffffffffffff168773ffffffffffffffffffffffffffffffffffffffff167f03e874ff0400af332019e3388ba3ec252559e9e6b33b393b1335aaf4755384e35f878960405161072593929190612274565b60405180910390a35050505092915050565b5f60015f8473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f9054906101000a900460ff166107c1576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016107b890611e39565b60405180910390fd5b5f5f5f8573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f206040518060800160405290815f82015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001600182015481526020016002820154815260200160038201548152505090505f83148061088e57505f8160200151145b1561089c575f9150506108ca565b8281602001516108ac9190611f54565b8382604001516108bc9190611f87565b6108c69190611ff5565b9150505b92915050565b6001602052805f5260405f205f915054906101000a900460ff1681565b5f5f60015f8473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f9054906101000a900460ff16610978576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161096f90611e39565b60405180910390fd5b5f5f5f8573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f206040518060800160405290815f82015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200160018201548152602001600282015481526020016003820154815250509050806020015181604001519250925050915091565b5f60015f8373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f9054906101000a900460ff16610ad2576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610ac990611e39565b60405180910390fd5b5f5f5f8473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f206040518060800160405290815f82015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001600182015481526020016002820154815260200160038201548152505090505f816020015103610ba2575f915050610bcd565b8060200151670de0b6b3a76400008260400151610bbf9190611f87565b610bc99190611ff5565b9150505b919050565b5f60015f8573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f9054906101000a900460ff16610c5c576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610c5390611e39565b60405180910390fd5b5f83118015610c6a57505f82115b610ca9576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610ca0906122f3565b60405180910390fd5b5f5f5f8673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f2090505f8160010154826002015486610cfe9190611f87565b610d089190611ff5565b90506064606382610d199190611f87565b610d239190611ff5565b841015610d65576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610d5c9061235b565b60405180910390fd5b5f81851115610d745781610d76565b845b90505f8360020154846001015483610d8e9190611f87565b610d989190611ff5565b905086811015610da6578096505b5f5f8973ffffffffffffffffffffffffffffffffffffffff1633308b604051602401610dd493929190612379565b6040516020818303038152906040527f23b872dd000000000000000000000000000000000000000000000000000000007bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19166020820180517bffffffffffffffffffffffffffffffffffffffffffffffffffffffff8381831617835250505050604051610e5e91906121a1565b5f604051808303815f865af19150503d805f8114610e97576040519150601f19603f3d011682016040523d82523d5f602084013e610e9c565b606091505b5091509150818015610ec957505f81511480610ec8575080806020019051810190610ec791906121e1565b5b5b610f08576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610eff90612256565b60405180910390fd5b83341015610f4b576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610f4290611f09565b60405180910390fd5b856001015486600301548a610f609190611f87565b610f6a9190611ff5565b965088866001015f828254610f7f9190611f54565b9250508190555083866002015f828254610f999190611f54565b9250508190555086866003015f828254610fb39190611f54565b9250508190555083341115611012573373ffffffffffffffffffffffffffffffffffffffff166108fc8534610fe891906120f5565b90811502906040515f60405180830381858888f19350505050158015611010573d5f5f3e3d5ffd5b505b3373ffffffffffffffffffffffffffffffffffffffff168a73ffffffffffffffffffffffffffffffffffffffff167f4a1a2a6176e9646d9e3157f7c2ab3c499f18337c0b0828cfb28e0a61de4a11f78b878b604051611073939291906123ae565b60405180910390a35050505050509392505050565b5f60015f8473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f9054906101000a900460ff16611112576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161110990611e39565b60405180910390fd5b5f5f5f8573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f206040518060800160405290815f82015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001600182015481526020016002820154815260200160038201548152505090505f8314806111df57505f8160400151145b156111ed575f91505061121b565b8281604001516111fd9190611f54565b83826020015161120d9190611f87565b6112179190611ff5565b9150505b92915050565b5f602052805f5260405f205f91509050805f015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff16908060010154908060020154908060030154905084565b5f73ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff16036112d9576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016112d09061242d565b60405180910390fd5b60015f8473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f9054906101000a900460ff1615611363576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161135a90612495565b60405180910390fd5b5f8211801561137157505f81115b6113b0576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016113a7906122f3565b60405180910390fd5b5f5f8473ffffffffffffffffffffffffffffffffffffffff163330866040516024016113de93929190612379565b6040516020818303038152906040527f23b872dd000000000000000000000000000000000000000000000000000000007bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19166020820180517bffffffffffffffffffffffffffffffffffffffffffffffffffffffff838183161783525050505060405161146891906121a1565b5f604051808303815f865af19150503d805f81146114a1576040519150601f19603f3d011682016040523d82523d5f602084013e6114a6565b606091505b50915091508180156114d357505f815114806114d25750808060200190518101906114d191906121e1565b5b5b611512576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161150990612256565b60405180910390fd5b82341015611555576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161154c90611f09565b60405180910390fd5b60405180608001604052808673ffffffffffffffffffffffffffffffffffffffff16815260200185815260200184815260200161159c85876115979190611f87565b611b50565b8152505f5f8773ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f820151815f015f6101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055506020820151816001015560408201518160020155606082015181600301559050506001805f8773ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f6101000a81548160ff021916908315150217905550823411156116ec573373ffffffffffffffffffffffffffffffffffffffff166108fc84346116c291906120f5565b90811502906040515f60405180830381858888f193505050501580156116ea573d5f5f3e3d5ffd5b505b8473ffffffffffffffffffffffffffffffffffffffff167f620f7d92e94f37e846b7a037fa45c886f3ab726b58c6531813825a47ad4eec508585604051611734929190611d16565b60405180910390a25050505050565b5f60015f8473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f9054906101000a900460ff166117cd576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016117c490611e39565b60405180910390fd5b5f821161180f576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161180690611ea1565b60405180910390fd5b5f5f5f8573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f20905082816001015461185e9190611f54565b83826002015461186e9190611f87565b6118789190611ff5565b91505f82116118bc576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016118b39061206f565b60405180910390fd5b8060020154821115611903576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016118fa906124fd565b60405180910390fd5b5f5f8573ffffffffffffffffffffffffffffffffffffffff1633308760405160240161193193929190612379565b6040516020818303038152906040527f23b872dd000000000000000000000000000000000000000000000000000000007bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19166020820180517bffffffffffffffffffffffffffffffffffffffffffffffffffffffff83818316178352505050506040516119bb91906121a1565b5f604051808303815f865af19150503d805f81146119f4576040519150601f19603f3d011682016040523d82523d5f602084013e6119f9565b606091505b5091509150818015611a2657505f81511480611a25575080806020019051810190611a2491906121e1565b5b5b611a65576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401611a5c90612256565b60405180910390fd5b84836001015f828254611a789190611f54565b9250508190555083836002015f828254611a9291906120f5565b925050819055503373ffffffffffffffffffffffffffffffffffffffff166108fc8590811502906040515f60405180830381858888f19350505050158015611adc573d5f5f3e3d5ffd5b503373ffffffffffffffffffffffffffffffffffffffff168673ffffffffffffffffffffffffffffffffffffffff167f03e874ff0400af332019e3388ba3ec252559e9e6b33b393b1335aaf4755384e360018888604051611b3f93929190612274565b60405180910390a350505092915050565b5f5f8203611b60575f9050611bbc565b5f6002600184611b709190611f54565b611b7a9190611ff5565b90505f8390505b80821015611bb6578190506002828386611b9b9190611ff5565b611ba59190611f54565b611baf9190611ff5565b9150611b81565b80925050505b919050565b5f5ffd5b5f73ffffffffffffffffffffffffffffffffffffffff82169050919050565b5f611bee82611bc5565b9050919050565b611bfe81611be4565b8114611c08575f5ffd5b50565b5f81359050611c1981611bf5565b92915050565b5f819050919050565b611c3181611c1f565b8114611c3b575f5ffd5b50565b5f81359050611c4c81611c28565b92915050565b5f5f60408385031215611c6857611c67611bc1565b5b5f611c7585828601611c0b565b9250506020611c8685828601611c3e565b9150509250929050565b611c9981611c1f565b82525050565b5f602082019050611cb25f830184611c90565b92915050565b5f60208284031215611ccd57611ccc611bc1565b5b5f611cda84828501611c0b565b91505092915050565b5f8115159050919050565b611cf781611ce3565b82525050565b5f602082019050611d105f830184611cee565b92915050565b5f604082019050611d295f830185611c90565b611d366020830184611c90565b9392505050565b5f5f5f60608486031215611d5457611d53611bc1565b5b5f611d6186828701611c0b565b9350506020611d7286828701611c3e565b9250506040611d8386828701611c3e565b9150509250925092565b611d9681611be4565b82525050565b5f608082019050611daf5f830187611d8d565b611dbc6020830186611c90565b611dc96040830185611c90565b611dd66060830184611c90565b95945050505050565b5f82825260208201905092915050565b7f506f6f6c20646f6573206e6f74206578697374000000000000000000000000005f82015250565b5f611e23601383611ddf565b9150611e2e82611def565b602082019050919050565b5f6020820190508181035f830152611e5081611e17565b9050919050565b7f416d6f756e74206d7573742062652067726561746572207468616e20300000005f82015250565b5f611e8b601d83611ddf565b9150611e9682611e57565b602082019050919050565b5f6020820190508181035f830152611eb881611e7f565b9050919050565b7f496e73756666696369656e7420555344432073656e74000000000000000000005f82015250565b5f611ef3601683611ddf565b9150611efe82611ebf565b602082019050919050565b5f6020820190508181035f830152611f2081611ee7565b9050919050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52601160045260245ffd5b5f611f5e82611c1f565b9150611f6983611c1f565b9250828201905080821115611f8157611f80611f27565b5b92915050565b5f611f9182611c1f565b9150611f9c83611c1f565b9250828202611faa81611c1f565b91508282048414831517611fc157611fc0611f27565b5b5092915050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52601260045260245ffd5b5f611fff82611c1f565b915061200a83611c1f565b92508261201a57612019611fc8565b5b828204905092915050565b7f496e73756666696369656e74206c6971756964697479000000000000000000005f82015250565b5f612059601683611ddf565b915061206482612025565b602082019050919050565b5f6020820190508181035f8301526120868161204d565b9050919050565b7f496e73756666696369656e7420746f6b656e20726573657276650000000000005f82015250565b5f6120c1601a83611ddf565b91506120cc8261208d565b602082019050919050565b5f6020820190508181035f8301526120ee816120b5565b9050919050565b5f6120ff82611c1f565b915061210a83611c1f565b925082820390508181111561212257612121611f27565b5b92915050565b5f60408201905061213b5f830185611d8d565b6121486020830184611c90565b9392505050565b5f81519050919050565b5f81905092915050565b8281835e5f83830152505050565b5f61217b8261214f565b6121858185612159565b9350612195818560208601612163565b80840191505092915050565b5f6121ac8284612171565b915081905092915050565b6121c081611ce3565b81146121ca575f5ffd5b50565b5f815190506121db816121b7565b92915050565b5f602082840312156121f6576121f5611bc1565b5b5f612203848285016121cd565b91505092915050565b7f546f6b656e207472616e73666572206661696c656400000000000000000000005f82015250565b5f612240601583611ddf565b915061224b8261220c565b602082019050919050565b5f6020820190508181035f83015261226d81612234565b9050919050565b5f6060820190506122875f830186611cee565b6122946020830185611c90565b6122a16040830184611c90565b949350505050565b7f416d6f756e7473206d7573742062652067726561746572207468616e203000005f82015250565b5f6122dd601e83611ddf565b91506122e8826122a9565b602082019050919050565b5f6020820190508181035f83015261230a816122d1565b9050919050565b7f416d6f756e7473206e6f7420696e20636f727265637420726174696f000000005f82015250565b5f612345601c83611ddf565b915061235082612311565b602082019050919050565b5f6020820190508181035f83015261237281612339565b9050919050565b5f60608201905061238c5f830186611d8d565b6123996020830185611d8d565b6123a66040830184611c90565b949350505050565b5f6060820190506123c15f830186611c90565b6123ce6020830185611c90565b6123db6040830184611c90565b949350505050565b7f496e76616c696420746f6b656e206164647265737300000000000000000000005f82015250565b5f612417601583611ddf565b9150612422826123e3565b602082019050919050565b5f6020820190508181035f8301526124448161240b565b9050919050565b7f506f6f6c20616c726561647920657869737473000000000000000000000000005f82015250565b5f61247f601383611ddf565b915061248a8261244b565b602082019050919050565b5f6020820190508181035f8301526124ac81612473565b9050919050565b7f496e73756666696369656e7420555344432072657365727665000000000000005f82015250565b5f6124e7601983611ddf565b91506124f2826124b3565b602082019050919050565b5f6020820190508181035f830152612514816124db565b905091905056fea26469706673582212208b75d73c682504de92d93d14f19ff4bb5bbd417c0af120e7a61426943892faeb64736f6c634300081e0033';

export default function DeployAMM() {
  const { wallets } = useWallets();
  
  // Get wallet - prioritize external wallets
  const externalWallet = wallets.find(w => w.walletClientType !== 'privy' && w.walletClientType !== undefined);
  const embeddedWallet = wallets.find(w => w.walletClientType === 'privy');
  const wallet = externalWallet || embeddedWallet;
  
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState('');
  const [deployedAddress, setDeployedAddress] = useState('');
  
  // Check AMM_ADDRESS from config first, then localStorage
  const [ammAddress, setAmmAddress] = useState(() => {
    const configAddr = AMM_ADDRESS;
    const localAddr = localStorage.getItem('ammAddress');
    return configAddr || localAddr || '';
  });
  
  // Update if AMM_ADDRESS changes or localStorage changes
  useEffect(() => {
    const checkAMM = () => {
      const configAddr = AMM_ADDRESS;
      const localAddr = localStorage.getItem('ammAddress');
      const currentAddr = configAddr || localAddr || '';
      
      if (currentAddr && currentAddr !== ammAddress && ethers.isAddress(currentAddr)) {
        setAmmAddress(currentAddr);
      }
    };
    
    checkAMM();
    const interval = setInterval(checkAMM, 2000);
    return () => clearInterval(interval);
  }, [ammAddress]);
  
  const deployAMM = async () => {
    if (!wallet) {
      setError('Please connect wallet first');
      return;
    }
    
    const bytecode = SimpleAMMBytecode;
    if (!bytecode || !bytecode.startsWith('0x')) {
      setError('Bytecode not available. Please paste SimpleAMM bytecode manually or ensure contracts/SimpleAMM.json is accessible.');
      return;
    }
    
    setLoading(true);
    setError('');
    setDeployedAddress('');
    
    try {
      const provider = await wallet.getEthereumProvider();
      const ethersProvider = new ethers.BrowserProvider(provider);
      const signer = await ethersProvider.getSigner();
      
      console.log('Deploying SimpleAMM...');
      const tx = await signer.sendTransaction({
        data: bytecode,
      });
      
      console.log(`Transaction submitted: ${tx.hash}`);
      const receipt = await tx.wait();
      console.log(`SimpleAMM deployed at: ${receipt!.contractAddress}`);
      
      const contractAddress = receipt!.contractAddress!;
      setDeployedAddress(contractAddress);
      setAmmAddress(contractAddress);
      localStorage.setItem('ammAddress', contractAddress);
      
    } catch (err: any) {
      console.error('Error deploying SimpleAMM:', err);
      setError(`Failed to deploy SimpleAMM: ${err.message}`);
    } finally {
      setLoading(false);
    }
  };
  
  if (!wallet) {
    return null;
  }
  
  if (ammAddress && ethers.isAddress(ammAddress)) {
    return (
      <div style={{ 
        marginTop: '2rem', 
        padding: '1rem', 
        background: 'rgba(34, 197, 94, 0.15)', 
        borderRadius: '8px',
        border: '1px solid rgba(34, 197, 94, 0.3)'
      }}>
        <div style={{ fontSize: '1rem', fontWeight: 600, marginBottom: '0.5rem', color: '#e2e8f0' }}>
          ✅ SimpleAMM Contract is configured
        </div>
        <div style={{ fontSize: '0.85rem', color: '#cbd5e1', marginBottom: '0.5rem' }}>
          This enables liquid pricing and trading for all tokens
        </div>
        <div style={{ fontFamily: 'monospace', fontSize: '0.9rem', color: '#86efac', marginBottom: '0.5rem', padding: '0.5rem', background: 'rgba(15, 23, 42, 0.5)', borderRadius: '6px' }}>
          {ammAddress}
        </div>
        <button
          onClick={() => {
            navigator.clipboard.writeText(ammAddress);
          }}
          style={{
            padding: '0.5rem 1rem',
            fontSize: '0.85rem',
            background: 'rgba(71, 85, 105, 0.5)',
            color: '#e2e8f0',
            border: '1px solid rgba(71, 85, 105, 0.5)',
            borderRadius: '6px',
            cursor: 'pointer',
            transition: 'all 0.2s',
            marginRight: '0.5rem'
          }}
          onMouseEnter={(e) => e.currentTarget.style.background = 'rgba(71, 85, 105, 0.7)'}
          onMouseLeave={(e) => e.currentTarget.style.background = 'rgba(71, 85, 105, 0.5)'}
        >
          Copy Address
        </button>
        <a
          href={`https://testnet.arcscan.app/address/${ammAddress}`}
          target="_blank"
          rel="noopener noreferrer"
          style={{
            padding: '0.5rem 1rem',
            fontSize: '0.85rem',
            background: 'linear-gradient(135deg, #818cf8 0%, #a78bfa 100%)',
            color: 'white',
            textDecoration: 'none',
            borderRadius: '6px',
            fontWeight: 600,
            display: 'inline-block'
          }}
        >
          View on Arcscan →
        </a>
      </div>
    );
  }
  
  return (
    <div style={{ 
      marginTop: '2rem', 
      padding: '1rem', 
      background: 'rgba(34, 197, 94, 0.15)', 
      borderRadius: '8px',
      border: '1px solid rgba(34, 197, 94, 0.3)'
    }}>
      <div style={{ fontSize: '1rem', fontWeight: 600, marginBottom: '0.5rem', color: '#e2e8f0' }}>
        Deploy SimpleAMM Contract
      </div>
      <div style={{ fontSize: '0.9rem', color: '#cbd5e1', marginBottom: '1rem' }}>
        Deploy SimpleAMM contract to enable liquid pricing and trading for tokens. This allows tokens to have dynamic prices based on liquidity pools.
      </div>
      
      {error && (
        <div style={{ 
          marginBottom: '1rem', 
          padding: '0.75rem', 
          background: 'rgba(239, 68, 68, 0.2)',
          borderLeft: '4px solid #ef4444',
          borderRadius: '4px',
          color: '#fca5a5',
          fontSize: '0.9rem',
          border: '1px solid rgba(239, 68, 68, 0.3)'
        }}>
          <strong>Error:</strong> {error}
        </div>
      )}
      
      {deployedAddress && (
        <div style={{ 
          marginBottom: '1rem', 
          padding: '1rem', 
          background: 'rgba(34, 197, 94, 0.2)',
          borderLeft: '4px solid #22c55e',
          borderRadius: '4px',
          color: '#86efac',
          border: '1px solid rgba(34, 197, 94, 0.3)'
        }}>
          <strong>✅ SimpleAMM Deployed Successfully!</strong>
          <div style={{ marginTop: '0.75rem', fontFamily: 'monospace', fontSize: '0.9rem', color: '#cbd5e1' }}>
            <div style={{ marginBottom: '0.5rem' }}>
              <strong>Contract Address:</strong><br />
              {deployedAddress}
            </div>
          </div>
          <div style={{ marginTop: '0.75rem', fontSize: '0.85rem', color: '#cbd5e1' }}>
            Address has been saved to localStorage. You can now deploy tokens with liquidity pools!
          </div>
          <div style={{ marginTop: '0.75rem' }}>
            <a 
              href={`https://testnet.arcscan.app/address/${deployedAddress}`}
              target="_blank"
              rel="noopener noreferrer"
              style={{ color: '#a78bfa', textDecoration: 'none', fontSize: '0.9rem', fontWeight: 600 }}
            >
              View on Arcscan →
            </a>
          </div>
        </div>
      )}
      
      <button
        onClick={deployAMM}
        disabled={loading || !SimpleAMMBytecode}
        style={{
          padding: '0.75rem 1.5rem',
          fontSize: '1rem',
          background: loading || !SimpleAMMBytecode
            ? 'rgba(71, 85, 105, 0.5)'
            : 'linear-gradient(135deg, #22c55e 0%, #16a34a 100%)',
          color: 'white',
          border: 'none',
          borderRadius: '8px',
          cursor: loading || !SimpleAMMBytecode ? 'not-allowed' : 'pointer',
          fontWeight: 600,
          transition: 'transform 0.2s',
          width: '100%'
        }}
        onMouseEnter={(e) => {
          if (!loading && SimpleAMMBytecode) {
            e.currentTarget.style.transform = 'scale(1.02)';
          }
        }}
        onMouseLeave={(e) => {
          e.currentTarget.style.transform = 'scale(1)';
        }}
      >
        {loading ? 'Deploying...' : 'Deploy SimpleAMM'}
      </button>
    </div>
  );
}

